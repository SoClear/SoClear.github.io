# 数组和特殊矩阵

## 3.4.3 特殊矩阵的压缩存储

### 3.4.3.1 对称矩阵

将n阶对称矩阵存放在一维数组 `B[n(n+l)/2]` 中  
存储下三角，行优先  
元素下标之间的对应关系如下:

$$
k = \left\{  \begin{array}{ll} \displaystyle\frac{i\left( {i - 1}\right) }{2} + j - 1, & i \geq  j\text{ (下三角区和主对角线元素 } \\\\  \displaystyle\frac{j\left( {j - 1}\right) }{2} + i - 1, & i < j\text{ (上三角区元素 }{a}_{i,j} = {a}_{j,i}\text{ ) } \end{array}\right.
$$

### 3.4.3.2 三角矩阵

n 阶下三角矩阵压缩存储在 `B[n(n+1)/2+1]`中  
存储下三角，行优先  
元素下标之间的对应关系为

$$
k = \left\{  \begin{array}{ll} \displaystyle\frac{i\left( {i - 1}\right) }{2} + j - 1, & i \geq  j\text{ (下三角区和主对角线元素) } \\\\ \displaystyle\frac{n\left( {n + 1}\right) }{2}, & i < j\text{ (上三角区元素) } \end{array}\right.
$$

存储上三角，行优先  
元素下标之间的对应关系为

$$
k = \left\{  \begin{array}{ll} \displaystyle\frac{\left( {i - 1}\right) \left( {{2n} - i + 2}\right) }{2} + \left( {j - i}\right) , & i \leq  j\text{ (上三角区和主对角线元素) } \\\\  \displaystyle\frac{n\left( {n + 1}\right) }{2}, & i > j\text{ (下三角区元素) } \end{array}\right.
$$

### 3.4.3.3 三对角矩阵

由此可以计算矩阵 $A$ 中 3 条对角线上的元素 ${a}_{ij}\left( {1 \leq  i,j \leq  n,\left| {i - j}\right|  \leq  1}\right)$ 在一维数组 $\mathrm{B}$ 中存放的下标为 $k = {2i} + j - 3$ 。B 存储了 3n-2 个元素。

反之,若已知三对角矩阵中的某个元素 ${a}_{i,j}$ 存放在一维数组 $\mathrm{B}$ 的第 $k$ 个位置,则有 $i = \lfloor \left( {k + 1}\right) /3 + 1\rfloor$ , $j = k - {2i} + 3$ 。

## 3.4.5 本节试题精选

05 二维数组 A 按行优先存储,其中每个元素占 1 个存储单元。若 `A[1][1]` 的存储地址为
420, `A[3][3]` 的存储地址为 446, 则 `A[5][5]` 的存储地址为 ( )。

A. 472 B. 471 C. 458 D. 457

06 将三角矩阵即数组 `A[1...100][1...100]` 按行优先存入一维数组 `B[1...298]` 中, 数组 A 中元素 `A[66][65]` 在数组 B 中的位置 k 为 ( )。

A. 198 B. 195 C. 197 D. 196

11 【2016 统考真题】有一个 100 阶的三对角矩阵 $M$ ,其元素 ${m}_{ij}\left( {1 \leq  i,j \leq  {100}}\right)$ 按行优先依次压缩存入下标从 0 开始的一维数组 $\mathrm{N}$ 中。元素 ${m}_{{30},{30}}$ 在 $\mathrm{N}$ 中的下标是 ( ) 。

A. 86 B. 87 C. 88 D. 89

14 【2020 统考真题】将一个 ${10} \times  {10}$ 阶对称矩阵 $\mathbf{M}$ 的上三角部分的元素 ${m}_{i,j}\left( {1 \leq  i \leq  j \leq  {10}}\right)$ 按列优先存入 $\mathrm{C}$ 语言的一维数组 $\mathrm{N}$ 中,元素 ${m}_{7,2}$ 在 $\mathrm{N}$ 中的下标是 $\left( \;\right)$ 。

A. 15 B. 16 C. 22 D. 23

## 3.4.6 答案与解析

05 A

本题未直接给出数组 A 的行数和列数,因此需要根据题目中的信息来推理。因为该二维数组按行优先存储, 且 `A[3][3]` 的存储地址为 446, 所以 `A[3][1]` 的存储地址为 444, 又 A[1] [1] 的存储地址为 420, 显然 `A[1][1]` 和 `A[3][1]` 正好相差 2 行, 所以该矩阵的列数为 12 。而 `A[5][3]` 和 `A[3][3]` 正好相差 2 行, `A[5][5]` 和 `A[5][3]` 又相差 2 个元素,所以 `A[5][5]` 的存储地址

是 446+24+2 = 472 。

06 B

对于三对角矩阵,将 `A[1...n][1..n]` 压缩至 `B[1..3n-2]` 时, ${a}_{i,j}$ 与 ${b}_{k}$ 的对应关系为 $k = {2i} + j - 2$ 。 则 A 中的元素 `A[66][65]` 在数组 B 中的位置 k 为 $2 \times  {66} + {65} - 2 = {195}$ 。

11 B

三对角矩阵如下所示。

$$
\left\lbrack  \begin{matrix} {a}_{1,1} & {a}_{1,2} & & & & \\  {a}_{2,1} & {a}_{2,2} & {a}_{2,3} & & 0 & \\   & {a}_{3,2} & {a}_{3,3} & {a}_{3,4} & & \\   & &  \ddots  &  \ddots  &  \ddots  & \\   & 0 & & {a}_{n - 1,n - 2} & {a}_{n - 1,n - 1} & {a}_{n - 1,n} \\   & & & & {a}_{n,n - 1} & {a}_{n,n} \end{matrix}\right\rbrack  
$$

采用压缩存储,将 3 条对角线上的元素按行优先方式存放在一维数组 $\mathrm{B}$ 中,且 ${a}_{1,1}$ 存放于 $\mathrm{B}\left\lbrack  0\right\rbrack$ 中, 其存储形式如下所示:

$$
a_{1,1} ， a_{1,2} ，a_{2,1} ，a_{2,2}， a_{2,3}， \dots ， a_{n-1,n}， a_{n,n-1}， a_{n,n}
$$
可以计算矩阵 $\mathbf{A}$ 中 3 条对角线上的元素 ${a}_{ij}\left( {1 \leq  i,j \leq  n,\left| {i - j}\right|  \leq  1}\right)$ 在一维数组 $\mathrm{B}$ 中存放的下标为 $k = {2i} + j - 3$ ,公式很难记忆,我们通常采用解法 2 。

解法 1: 针对该题,仅需将数字逐一代入公式: $k = 2 \times  {30} + {30} - 3 = {87}$ ,结果为 87 。

解法 2: 观察上图的三对角矩阵不难发现,第一行有两个元素,剩下的在元素 ${m}_{{30},{30}}$ 所在行之前的 28 行 (注意下标 $1 \leq  i,j \leq  {100}$ ) 中,每行都有 3 个元素,而 ${m}_{{30},{30}}$ 之前仅有一个元素 ${m}_{{30},{29}}$ , 不难发现元素 ${m}_{{30},{30}}$ 在数组 $N$ 中的下标是 $2 + {28} \times  3 + 2 - 1 = {87}$ 。

> 注意
>
> 矩阵和数组的下标从 0 或 1 开始 (如矩阵可能从 ${a}_{0,0}$ 或 ${a}_{1,1}$ 开始,数组可能从 B[0] 或 B[1] 开始), 这时就需要适时调整计算方法 (方法无非是多计算 1 或少计算 1 的问题)。

14 C

上三角矩阵按列优先存储, 先存储只有 1 个元素的第一列, 再存储有 2 个元素的第二列, 以此类推。 ${m}_{7,2}$ 位于左下角,对应右上角的元素为 ${m}_{2,7}$ ,在 ${m}_{2,7}$ 之前存有

第 1 列: 1

第 2 列: 2

$\ldots \ldots$

第 6 列: 6

第 7 列: 1

前面共存储有 $1 + 2 + 3 + 4 + 5 + 6 + 1 = {22}$ 个元素（数组下标范围为 $0 \sim  {21}$ ）,注意数组下标从 0 开始,所以 ${m}_{2,7}$ 在数组 $\mathrm{N}$ 中的下标为 22,即 ${m}_{7,2}$ 在数组 $\mathrm{N}$ 中的下标为 22 。
