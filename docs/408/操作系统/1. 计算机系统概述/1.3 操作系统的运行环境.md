# 1.3 操作系统的运行环境

## 1.3.4 本节习题精选

02 下列说法中, 正确的是 ( )。  
I. 批处理的主要缺点是需要大量内存  
II. 当计算机提供了核心态和用户态时, 输入/输出指令必须在核心态下执行  
III. 操作系统中采用多道程序设计技术的最主要原因是提高 CPU 和外部设备的可靠性  
IV. 操作系统中, 通道技术是一种硬件技术  
A. I. II B. I、III C. II、IV D. II、III、IV

04 ( ) 是操作系统必须提供的功能。  
A. 图形用户界面 (GUI) B. 为进程提供系统调用命令  
C. 中断处理 D. 编译源程序

08 计算机区分核心态和用户态指令后, 从核心态到用户态的转换是由操作系统程序执行后完成的, 而用户态到核心态的转换则是由 ( ) 完成的。  
A. 硬件 B. 核心态程序  
C. 用户程序 D. 中断处理程序

10 在操作系统中, 只能在核心态下运行的指令是 ( )。  
A. 读时钟指令 B. 置时钟指令 C. 取数指令 D. 寄存器清零

14 在操作系统中, 只能在核心态下执行的指令是 ( )。  
A. 读时钟 B. 取数 C. 系统调用命令 D. 寄存器清 “0”

18 下列中断事件中, 能引起外部中断的事件是 ( )。  
I. 时钟中断 II. 访管中断 III. 缺页中断  
A. I B. III C. I 和 II D. II 和 III

20 下列关于系统调用和一般过程调用的说法中, 正确的是 ( )。  
A. 两者都需要将当前 CPU 中的 PSW 和 PC 的值压栈, 以保存现场信息  
B. 系统调用的被调用过程一定运行在内核态  
C. 一般过程调用的被调用过程一定运行在用户态  
D. 两者的调用过程与被调用过程一定都运行在用户态

27 【2015 统考真题】处理外部中断时, 应该由操作系统保存的是 ( )。  
A. 程序计数器 (PC) 的内容 B. 通用寄存器的内容  
C. 块表 (TLB) 中的内容 D. Cache 中的内容

31.【2018 统考真题】定时器产生时钟中断后, 由时钟中断服务程序更新的部分内容是 ( )。  
I. 内核中时钟变量的值  
II. 当前进程占用 CPU 的时间  
III. 当前进程在时间片内的剩余执行时间  
A. 仅 I、II B. 仅 II、III C. 仅 I、III D. I、II、III

33.【2020 统考真题】下列与中断相关的操作中, 由操作系统完成的是 ( )。  
I. 保存被中断程序的中断点 II. 提供中断服务  
III. 初始化中断向量表 IV. 保存中断屏蔽字  
A. 仅 I、II B. 仅 I、II、IV C. 仅 III、IV D. 仅 II、III、IV

34 【2021 统考真题】下列指令中, 只能在内核态执行的是 ( )。  
A. trap 指令 B. I/O 指令 C. 数据传送指令 D. 设置断点指令

37.【2022 统考真题】执行系统调用的过程涉及下列操作，其中由操作系统完成的是 ( )。  
I. 保存断点和程序状态字 II. 保存通用寄存器的内容  
III. 执行系统调用服务例程 IV. 将 CPU 模式改为内核态  
A. 仅 I、III B. 仅 II、III C. 仅 II、IV D. 仅 II、III、IV

38.【2023 统考真题】在操作系统内核中, 中断向量表适合采用的数据结构是 ( )。  
A. 数组 B. 队列 C. 单向链表 D. 双向链表

## 1.3.5 答案与解析

02 C

I 错误: 批处理的主要缺点是缺少交互性。批处理系统的主要缺点是常考点, 读者对此要非常敏感。II 正确: 输入/输出指令属于特权指令, 只能由操作系统使用, 因此必须在核心态下执行。 III 错误: 多道性是为了提高系统利用率和吞吐量而提出的。IV 正确: I/O 通道实际上是一种特殊的处理器,它具有执行 I/O 指令的能力,并通过执行通道程序来控制 I/O 操作。

04 C

中断是操作系统必须提供的功能, 因为计算机的各种错误都需要中断处理, 核心态与用户态切换也需要中断处理。

08 A

计算机通过硬件中断机制完成由用户态到核心态的转换。B 显然不正确, 核心态程序只有在操作系统进入核心态后才可以执行。D 中的中断处理程序一般也在核心态执行, 因此无法完成“转换成核心态” 这一任务。若由用户程序将操作系统由用户态转换到核心态, 则用户程序中就可使用核心态指令,这就会威胁到计算机的安全,所以 C 不正确。

计算机通过硬件完成操作系统由用户态到核心态的转换, 这是通过中断机制来实现的。发生中断事件时, 由硬件中断机制将计算机状态置为核心态。

10 B

大多数计算机操作系统的内核包括四个方面的内容, 即时钟管理、中断机制、原语和系统控制的数据结构及处理, 其中第 4 部分实际上是系统调用类的指令 (广义指令)。A、C 和 D 三项均可以在汇编语言中涉及, 因此都可以运行在用户态。从另外的角度考虑, 若在用户态下允许执行 “置时钟指令”, 则一个用户进程可在时间片还未到之前把时钟改回去, 从而导致时间片永远不会用完, 进而导致该用户进程一直占用 CPU, 这显然是不合理的。

注 意

操作系统的主要功能是为应用程序的运行创建良好的环境, 为了达到这个目的, 内核提供一系列具备预定功能的多内核函数, 通过一组称为系统调用 (system call) 的接口呈现给用户。 系统调用将应用程序的请求传给内核, 调用相应的内核函数完成所需的处理, 将处理结果返回给应用程序，如果没有系统调用和内核函数，那么用户将不能编写大型应用程序。

14 C

系统调用命令必然工作在核心态。注意区分调用和执行, 系统调用的调用可能发生在用户态, 调用系统调用的那条指令不一定是特权指令, 但系统调用的执行一定在核心态。

18 A

外部中断是由 CPU 外部的事件引起的, 如 I/O 设备的请求、时钟信号等。内部中断 (也称异常) 是由 CPU 内部的事件引起的, 如访管指令、缺页异常等。

20 B

系统调用需要保存 PSW 和 PC 的值, 一般过程调用只需保存 PC 的值, A 错误。系统调用的被调用过程是操作系统中的程序, 是系统级程序, 必须运行在内核态, B 正确。一般过程调用的被调用程序与调用程序运行在同一个状态, 可能是系统态, 也可能是用户态, C 和 D 错误。

27 B

外部中断处理过程, PC 值由中断隐指令自动保存, 而通用寄存器内容由操作系统保存。块表 (TLB) 和 Cache 中的内容则由硬件机构保存。

31 D

时钟中断的主要工作是处理和时间有关的信息及决定是否执行调度程序。和时间有关的所有信息包括系统时间、进程的时间片、延时、使用 CPU 的时间、各种定时器。

33 D

当 CPU 检测到中断信号后, 由硬件自动保存被中断程序的断点 [程序计数器 (PC) 和程序状态字寄存器 (PSW)], I 错误。之后, 硬件找到该中断信号对应的中断向量, 中断向量指明中断服务程序入口地址 (各中断向量统一存放在中断向量表中, 该表由操作系统初始化, III 正确)。 接下来开始执行中断服务程序, 保存中断屏蔽字、保存各通用寄存器的值, 并提供与中断信号对应的中断服务, 中断服务程序属于操作系统内核, II 和 IV 正确。

34 B

在内核态下, CPU 可执行任何指令, 在用户态下 CPU 只能执行非特权指令, 而特权指令只能在内核态下执行。常见的特权指令有: ①有关对 I/O 设备操作的指令; ②有关访问程序状态的指令; ③存取特殊寄存器的指令; ④其他指令。A、C 和 D 都是提供给用户使用的指令, 可以在用户态执行, 只是可能会使 CPU 从用户态切换到内核态。

37 B

发生系统调用时, CPU 通过执行软中断指令将 CPU 的运行状态从用户态切换到内核态, 这个过程与中断和异常的响应过程相同, 由硬件负责保存断点和程序状态字, 并将 CPU 模式改为内核态。然后, 执行操作系统内核的系统调用入口程序, 该内核程序负责保存通用寄存器的内容, 再调用执行特定的系统调用服务例程。综上, I、IV 由硬件完成, II、III 由操作系统完成。

38 A

本题考查了 “计算机组成原理” 的考点, 并且综合了 “数据结构” 的内容。中断向量表用于存放中断处理程序的入口地址, CPU 通过查询得到中断类型号, 然后据此计算可以得到对应中断服务程序的入口地址在中断向量表的位置, 采用数组作为中断向量表的存储结构, 可实现时间为 $O\left( 1\right)$ 的快速访问,从而提高中断处理的效率。
